(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[291],{4286:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>x});var t=r(7876),a=r(4232),l=r(9099),o=r(1162),n=r(9848),i=r(5322),d=r(9200),c=r(5676),u=r(794),m=r(6167);function x(){let[e,s]=(0,a.useState)(!1),[r,d]=(0,a.useState)(""),[x,h]=(0,a.useState)(""),[p,y]=(0,a.useState)(""),[g,b]=(0,a.useState)(""),[f,j]=(0,a.useState)(""),[v,w]=(0,a.useState)(""),[N,k]=(0,a.useState)(!1),C=(0,l.useRouter)();(0,o.YL)();let[S,_]=(0,a.useState)([]),[E,A]=(0,a.useState)(null),[R,O]=(0,a.useState)([]),P=(0,a.useContext)(m.Rs);if(!P)throw Error("Component must be used within a UserProvider");let[q,L]=P;async function T(){try{let e=await (0,u.Ay)("https://suifunds.yuviewenergy.com/ajoajo-users/",{method:"GET"},!0);e.type===u.yl.SUCCESS?(console.log("Ajo users fetched successfully:",e.payload),Array.isArray(e.payload)?_(e.payload):e.payload&&Array.isArray(e.payload.results)?_(e.payload.results):(console.error("Response data is not an array:",e.payload),_([]))):e.type===u.yl.REDIRECT?(console.log("Redirect required:",e.link),e.link&&C.push(e.link)):e.type===u.yl.KNOWN_ERROR?(console.error("Known error fetching ajo users:",e.message),_([])):e.type===u.yl.EXPIRED&&(console.log("Session expired, redirecting to signin"),e.link&&C.push(e.link))}catch(e){console.error("Error fetching ajo users:",e),_([]),e instanceof Error&&e.message.includes("Network error")&&console.error("Network/CORS error - backend needs to allow cross-origin requests")}}(0,a.useEffect)(()=>{if(!(0,i.wR)())return void C.push("/");T()},[C]);let I=async e=>{if(e.preventDefault(),0===R.length)return void n.oR.error("Please select at least one member");k(!0);let t=S.filter(e=>R.includes(e.wallet_address)),a=t.map((e,s)=>({wallet:e.wallet_address,position:s+1}));try{let e=await (0,c.yZ)(r,parseInt(g),parseInt(v),parseFloat(p),a,q.wallet_address,"testnet");console.log(e);let l={address_link:e.groupId,name:r,digest:e.digest,description:x,cycle_duration_days:g,contribution_amount:p,start_cycle:v,participant_ids:t.map(e=>e.user.id),active:!0};console.log(l),(await (0,u.Ay)("https://suifunds.yuviewenergy.com/ajosavingsgroup/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)})).type===u.yl.SUCCESS&&s(!0)}catch(e){console.error("Error creating savings group:",e),n.oR.error("NO Coin available for transaction")}finally{k(!1)}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,t.jsx)("div",{className:"bg-white border-b border-gray-200 px-8 py-4",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-blue-600",children:"Create Pool"}),(0,t.jsx)("p",{className:"text-gray-600 text-sm mt-1",children:"Create your own Ajo pool and start inviting members."})]}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsxs)("span",{className:"text-gray-700 mr-3",children:[q.user.username,"!"]}),(0,t.jsx)("div",{className:"w-10 h-10 bg-orange-400 rounded-full flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-white font-medium text-sm",children:"N"})}),(0,t.jsx)("div",{className:"ml-2",children:(0,t.jsx)("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]})}),(0,t.jsx)("div",{className:"flex-1 p-8 bg-gray-50 overflow-y-auto",children:(0,t.jsx)("div",{className:"max-w-2xl",children:(0,t.jsxs)("form",{onSubmit:I,className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Group Name"}),(0,t.jsx)("input",{type:"text",value:r,onChange:e=>d(e.target.value),className:"w-full p-3 border border-gray-300 rounded-md bg-white",placeholder:"E.g Swift Growth Ajo Team",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Purpose of group"}),(0,t.jsx)("input",{type:"text",value:x,onChange:e=>h(e.target.value),className:"w-full p-3 border border-gray-300 rounded-md bg-white",placeholder:"Optional"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contribution Amount"}),(0,t.jsx)("input",{type:"number",value:p,onChange:e=>y(e.target.value),className:"w-full p-3 border border-gray-300 rounded-md bg-white",placeholder:"Input Amount...",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Frequency in days"}),(0,t.jsx)("input",{type:"number",value:g,onChange:e=>b(e.target.value),className:"w-full p-3 border border-gray-300 rounded-md bg-white",placeholder:"10, 20, 30 ...",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Add Members"}),(0,t.jsx)("select",{multiple:!0,value:R,onChange:e=>{O(Array.from(e.target.selectedOptions,e=>e.value))},className:"w-full p-3 border border-gray-300 rounded-md bg-white h-32",required:!0,children:Array.isArray(S)&&S.length>0?S.map(e=>(0,t.jsx)("option",{value:e.wallet_address,children:e.user.username},e.id)):(0,t.jsx)("option",{disabled:!0,children:"No users available"})}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Hold Ctrl/Cmd to select multiple members"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Payment after (cycle):"}),(0,t.jsx)("input",{type:"number",value:v,onChange:e=>w(e.target.value),className:"w-full p-3 border border-gray-300 rounded-md bg-white",placeholder:"1, 2, 3 ...",required:!0})]}),(0,t.jsx)("div",{className:"flex justify-end pt-4",children:(0,t.jsx)("button",{type:"submit",disabled:N,className:"bg-blue-500 hover:bg-blue-600 text-white px-8 py-3 rounded-md font-medium disabled:opacity-50",children:N?"Creating...":"Create"})})]})})})]}),e&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-8 text-center relative",children:[(0,t.jsx)("button",{onClick:()=>s(!1),className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",children:(0,t.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("img",{src:"/suiflow.png",className:"w-16 h-16 mx-auto mb-4",alt:"Sui-Fund Logo"}),(0,t.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Congratulations!"}),(0,t.jsxs)("p",{className:"text-gray-600",children:["You've successfully created your  group.",(0,t.jsx)("br",{})]})]})]})})]})}x.getLayout=function(e){return(0,t.jsx)(d.A,{children:e})}},8356:(e,s,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/create-pool",function(){return r(4286)}])}},e=>{var s=s=>e(e.s=s);e.O(0,[141,528,676,636,593,792],()=>s(8356)),_N_E=e.O()}]);