(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[291],{4286:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>x});var r=t(7876),a=t(4232),l=t(9099),o=t(1162),n=t(9848),i=t(5322),d=t(9200),c=t(5676),u=t(794),m=t(6167);function x(){let[e,s]=(0,a.useState)(!1),[t,d]=(0,a.useState)(""),[x,p]=(0,a.useState)(""),[h,g]=(0,a.useState)(""),[y,b]=(0,a.useState)(""),[j,f]=(0,a.useState)(""),[v,w]=(0,a.useState)(""),[N,k]=(0,a.useState)(!1),C=(0,l.useRouter)();(0,o.YL)();let[S,_]=(0,a.useState)([]),[E,A]=(0,a.useState)(null),[R,O]=(0,a.useState)([]),P=(0,a.useContext)(m.Rs);if(!P)throw Error("Component must be used within a UserProvider");let[q,L]=P;async function T(){try{let e=await (0,u.Ay)("https://appi.vandies.com/ajoajo-users/",{method:"GET"},!0);e.type===u.yl.SUCCESS?(console.log("Ajo users fetched successfully:",e.payload),Array.isArray(e.payload)?_(e.payload):e.payload&&Array.isArray(e.payload.results)?_(e.payload.results):(console.error("Response data is not an array:",e.payload),_([]))):e.type===u.yl.REDIRECT?(console.log("Redirect required:",e.link),e.link&&C.push(e.link)):e.type===u.yl.KNOWN_ERROR?(console.error("Known error fetching ajo users:",e.message),_([])):e.type===u.yl.EXPIRED&&(console.log("Session expired, redirecting to signin"),e.link&&C.push(e.link))}catch(e){console.error("Error fetching ajo users:",e),_([]),e instanceof Error&&e.message.includes("Network error")&&console.error("Network/CORS error - backend needs to allow cross-origin requests")}}(0,a.useEffect)(()=>{if(!(0,i.wR)())return void C.push("/");T()},[C]);let I=async e=>{if(e.preventDefault(),0===R.length)return void n.oR.error("Please select at least one member");k(!0);let r=S.filter(e=>R.includes(e.wallet_address)),a=r.map((e,s)=>({wallet:e.wallet_address,position:s+1}));try{let e=await (0,c.yZ)(t,parseInt(y),parseInt(v),parseFloat(h),a,q.wallet_address,"testnet");console.log(e);let l={address_link:e.groupId,name:t,digest:e.digest,description:x,cycle_duration_days:y,contribution_amount:h,start_cycle:v,participant_ids:r.map(e=>e.user.id),active:!0};console.log(l),(await (0,u.Ay)("https://appi.vandies.com/ajosavingsgroup/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)})).type===u.yl.SUCCESS&&s(!0)}catch(e){console.error("Error creating savings group:",e),n.oR.error("NO Coin available for transaction")}finally{k(!1)}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,r.jsx)("div",{className:"bg-white border-b border-gray-200 px-8 py-4",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-blue-600",children:"Create Pool"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm mt-1",children:"Create your own Ajo pool and start inviting members."})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("span",{className:"text-gray-700 mr-3",children:[q.user.username,"!"]}),(0,r.jsx)("div",{className:"w-10 h-10 bg-orange-400 rounded-full flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-white font-medium text-sm",children:"N"})}),(0,r.jsx)("div",{className:"ml-2",children:(0,r.jsx)("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]})}),(0,r.jsx)("div",{className:"flex-1 p-8 bg-gray-50 overflow-y-auto",children:(0,r.jsx)("div",{className:"max-w-2xl",children:(0,r.jsxs)("form",{onSubmit:I,className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Group Name"}),(0,r.jsx)("input",{type:"text",value:t,onChange:e=>d(e.target.value),className:"w-full p-3 border border-gray-300 rounded-md bg-white",placeholder:"E.g Swift Growth Ajo Team",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Purpose of group"}),(0,r.jsx)("input",{type:"text",value:x,onChange:e=>p(e.target.value),className:"w-full p-3 border border-gray-300 rounded-md bg-white",placeholder:"Optional"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contribution Amount"}),(0,r.jsx)("input",{type:"number",value:h,onChange:e=>g(e.target.value),className:"w-full p-3 border border-gray-300 rounded-md bg-white",placeholder:"Input Amount...",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Frequency in days"}),(0,r.jsx)("input",{type:"number",value:y,onChange:e=>b(e.target.value),className:"w-full p-3 border border-gray-300 rounded-md bg-white",placeholder:"10, 20, 30 ...",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Add Members"}),(0,r.jsx)("select",{multiple:!0,value:R,onChange:e=>{O(Array.from(e.target.selectedOptions,e=>e.value))},className:"w-full p-3 border border-gray-300 rounded-md bg-white h-32",required:!0,children:Array.isArray(S)&&S.length>0?S.map(e=>(0,r.jsx)("option",{value:e.wallet_address,children:e.user.username},e.id)):(0,r.jsx)("option",{disabled:!0,children:"No users available"})}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Hold Ctrl/Cmd to select multiple members"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Payment after (cycle):"}),(0,r.jsx)("input",{type:"number",value:v,onChange:e=>w(e.target.value),className:"w-full p-3 border border-gray-300 rounded-md bg-white",placeholder:"1, 2, 3 ...",required:!0})]}),(0,r.jsx)("div",{className:"flex justify-end pt-4",children:(0,r.jsx)("button",{type:"submit",disabled:N,className:"bg-blue-500 hover:bg-blue-600 text-white px-8 py-3 rounded-md font-medium disabled:opacity-50",children:N?"Creating...":"Create"})})]})})})]}),e&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-8 text-center relative",children:[(0,r.jsx)("button",{onClick:()=>s(!1),className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("img",{src:"/suiflow.png",className:"w-16 h-16 mx-auto mb-4",alt:"Sui-Fund Logo"}),(0,r.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Congratulations!"}),(0,r.jsxs)("p",{className:"text-gray-600",children:["You've successfully created your  group.",(0,r.jsx)("br",{})]})]})]})})]})}x.getLayout=function(e){return(0,r.jsx)(d.A,{children:e})}},8356:(e,s,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/create-pool",function(){return t(4286)}])}},e=>{var s=s=>e(e.s=s);e.O(0,[141,528,676,636,593,792],()=>s(8356)),_N_E=e.O()}]);