(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[845],{4831:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>g});var t=r(7876),l=r(4232),o=r(9099),a=r(9848),n=r(5322),i=r(7104),c=r(794),d=r(6167),u=r(5676),h=r(9200);let p=new i.h;function g(){let[e,s]=(0,l.useState)(!1),[r,h]=(0,l.useState)(!0),[g,x]=(0,l.useState)(!1),[y,m]=(0,l.useState)(0),f=(0,o.useRouter)(),[j,w]=(0,l.useState)(0),b=(0,l.useContext)(d.Rs);if(!b)throw Error("Component must be used within a UserProvider");let[k,N]=b,v=async()=>{try{localStorage.getItem("accessToken")||localStorage.getItem("authToken"),(0,c.Ay)("https://appi.vandies.com/ajosavingsgroup/").then(e=>{e.type===c.yl.SUCCESS&&(console.log(e),w(e.payload.count))}).then(()=>{h(!1)})}catch(e){console.error("Error fetching ajo groups:",e),a.oR.error("Failed to fetch your groups")}finally{h(!1)}},E=(0,l.useCallback)(async()=>{try{let e=await (0,c.Ay)("https://appi.vandies.com/ajoajo-users/",{method:"GET"},!0);e.type===c.yl.SUCCESS?console.log("Ajo users fetched successfully:",e.payload):e.type===c.yl.REDIRECT?(console.log("Redirect required:",e.link),e.link&&f.push(e.link)):e.type===c.yl.KNOWN_ERROR?console.error("Known error getting ajo users:",e.message):e.type===c.yl.EXPIRED&&(console.log("Session expired, redirecting to signin"),e.link&&f.push(e.link))}catch(e){console.error("Error getting ajo users:",e),e instanceof Error&&e.message.includes("Network error")&&console.error("Network/CORS error - backend needs to allow cross-origin requests")}},[f]),S=(0,l.useCallback)(async()=>{console.log("called update wallet address");try{let e=await (0,c.Ay)("https://appi.vandies.com/ajoajo-users/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wallet_address:p.getSecretKey()})},!0);e.type===c.yl.SUCCESS?console.log("Wallet address updated successfully:",e.payload):e.type===c.yl.REDIRECT?(console.log("Redirect required:",e.link),e.link&&f.push(e.link)):e.type===c.yl.KNOWN_ERROR?console.error("Known error updating wallet address:",e.message):e.type===c.yl.EXPIRED&&(console.log("Session expired, redirecting to signin"),e.link&&f.push(e.link))}catch(e){console.error("Error updating wallet address:",e),e instanceof Error&&e.message.includes("Network error")&&console.error("Network/CORS error - backend needs to allow cross-origin requests")}},[f]),C=(0,l.useCallback)(async()=>{console.log("called fetch current user");try{let e=await (0,c.Ay)("https://appi.vandies.com/ajoajo-users/1/",{method:"GET"},!0);if(e.type===c.yl.SUCCESS){if(console.log("User fetched successfully:",e.payload),e.payload&&N){console.log(e.payload),N(e.payload);let s=await (0,u.iH)(e.payload.wallet_address,"testnet");console.log(s),m(s.balanceInSui)}}else e.type===c.yl.REDIRECT?(console.log("Redirect required:",e.link),e.link&&f.push(e.link)):e.type===c.yl.KNOWN_ERROR?console.error("Known error fetching user:",e.message):e.type===c.yl.EXPIRED&&(console.log("Session expired, redirecting to signin"),e.link&&f.push(e.link))}catch(e){console.error("Error fetching current user:",e),e instanceof Error&&e.message.includes("Network error")&&console.error("Network/CORS error - backend needs to allow cross-origin requests")}},[N,f]);(0,l.useEffect)(()=>{if(console.log("called use effect in home"),!(0,n.wR)())return void f.push("/");g||(console.log("initializing wallet and user data"),S(),E(),x(!0),C(),v())},[f,S,E,g]);let[R,_]=(0,l.useState)(!1),O=async()=>{try{await navigator.clipboard.writeText(i.h.fromSecretKey(k.wallet_address).getPublicKey().toSuiAddress()),_(!0),a.oR.info("Wallet address copied"),setTimeout(()=>{_(!1)},2e3)}catch(e){console.error("Failed to copy text:",e)}};return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,t.jsx)("div",{className:"bg-white border-b border-gray-200 px-8 py-4",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-blue-600",children:"Dashboard"}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsxs)("span",{className:"text-gray-700 mr-3",children:[k.user.username,"!"]}),(0,t.jsx)("div",{className:"w-10 h-10 bg-orange-400 rounded-full flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-white font-medium text-sm",children:"N"})}),(0,t.jsx)("div",{className:"ml-2",children:(0,t.jsx)("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]})}),(0,t.jsxs)("div",{className:"flex-1 p-8 bg-gray-50",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-16",children:[(0,t.jsxs)("div",{className:"bg-blue-500 text-white p-6 rounded-lg relative",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-blue-100 text-sm",children:"SUI Wallet Balance"}),(0,t.jsx)("div",{className:"w-6 h-6 text-blue-200",children:(0,t.jsx)("button",{onClick:O,className:"flex items-center justify-center p-3 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors duration-200 group",title:"Click to copy 'hello' to clipboard",children:(0,t.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"w-6 h-6",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6m0 0a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})})]}),(0,t.jsxs)("div",{className:"text-3xl font-bold",children:["SUI ",y]})]}),(0,t.jsxs)("div",{className:"bg-blue-500 text-white p-6 rounded-lg relative",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-blue-100 text-sm",children:"All Groups"}),(0,t.jsx)("div",{className:"w-6 h-6 text-blue-200",children:(0,t.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})})})]}),(0,t.jsx)("div",{className:"text-3xl font-bold",children:j})]})]}),(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-24",children:[(0,t.jsx)("div",{onClick:()=>{f.push("/create-pool")},className:"w-32 h-24 border-2 border-dashed border-gray-400 rounded-lg flex items-center justify-center mb-6 cursor-pointer hover:border-gray-500 transition-colors",children:(0,t.jsx)("div",{className:"text-black text-4xl font-light",children:"+"})}),(0,t.jsx)("p",{className:"text-gray-600 text-lg text-center max-w-md",children:"Create your own Ajo group and start inviting members."})]})]})]})})}g.getLayout=function(e){return(0,t.jsx)(h.A,{children:e})}},4990:(e,s,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/home",function(){return r(4831)}])}},e=>{var s=s=>e(e.s=s);e.O(0,[696,636,593,792],()=>s(4990)),_N_E=e.O()}]);