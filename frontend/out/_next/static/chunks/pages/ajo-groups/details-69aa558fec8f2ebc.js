(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[38],{5560:(e,r,s)=>{"use strict";s.r(r),s.d(r,{GroupDetailsContributed:()=>l,GroupDetailsDashboard:()=>n,GroupDetailsMembers:()=>a,default:()=>i});var t=s(7876);s(4232);let a=()=>(0,t.jsxs)("div",{className:"bg-white rounded-lg p-6 mb-4 shadow-sm border border-gray-200",children:[(0,t.jsx)("div",{className:"h-8 w-64 bg-gray-200 rounded mb-6 animate-pulse"}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[void 0,void 0,void 0,void 0].map((e,r)=>(0,t.jsxs)("div",{className:"flex items-center p-4 rounded-lg bg-gray-100",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-gray-200 rounded-full mr-4 animate-pulse"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"h-5 w-32 bg-gray-200 rounded mb-2 animate-pulse"}),(0,t.jsx)("div",{className:"h-4 w-48 bg-gray-200 rounded animate-pulse"})]})]},r))})]}),l=()=>(0,t.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[(0,t.jsx)("div",{className:"h-8 w-64 bg-gray-200 rounded mb-6 animate-pulse"}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[void 0,void 0,void 0,void 0].map((e,r)=>(0,t.jsxs)("div",{className:"flex items-center p-4 rounded-lg bg-gray-100",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-gray-200 rounded-full mr-4 animate-pulse"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"h-5 w-32 bg-gray-200 rounded mb-2 animate-pulse"}),(0,t.jsx)("div",{className:"h-4 w-48 bg-gray-200 rounded animate-pulse"})]})]},r))})]}),n=()=>(0,t.jsxs)("div",{className:"bg-white rounded-lg p-6 mb-6 shadow-sm border border-gray-200",children:[(0,t.jsx)("div",{className:"flex items-center gap-2 mb-4",children:(0,t.jsx)("div",{className:"h-8 w-64 bg-gray-200 rounded animate-pulse"})}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[...Array(8)].map((e,r)=>(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"h-4 w-24 bg-gray-200 rounded animate-pulse inline-block mr-2"}),(0,t.jsx)("div",{className:"h-4 w-32 bg-gray-200 rounded animate-pulse inline-block"})]},r))}),(0,t.jsxs)("div",{className:"flex flex-col md:flex-row justify-between my-4 gap-4",children:[(0,t.jsx)("div",{className:"h-12 w-48 bg-gray-200 rounded-xl animate-pulse"}),(0,t.jsx)("div",{className:"h-12 w-48 bg-gray-200 rounded-xl animate-pulse"})]})]}),i=()=>(0,t.jsx)("div",{className:"flex-1 flex flex-col",children:(0,t.jsx)("div",{className:"flex-1 p-8 bg-gray-50 overflow-y-auto"})})},6781:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>v});var t=s(7876),a=s(4232),l=s(9099),n=s(9848),i=s(8822),o=s(1200),d=s(1155),c=s(1011);async function u(e){var r,s;let t=new d.Z;t.moveCall({target:"".concat("0xc9be599a1ce3605fcccaf86a1cd857d09bdf7f5f2acc39b775d13b1cbff52c35","::codeforge::get_cycle_summary"),arguments:[t.object(e)]});let a=new i.x({url:(0,o.T)("testnet")}),l=await a.devInspectTransactionBlock({transactionBlock:t,sender:"0x0000000000000000000000000000000000000000000000000000000000000000"});if(l.error)throw Error("Failed to get cycle summary: ".concat(l.error));let n=null==(s=l.results)||null==(r=s[0])?void 0:r.returnValues;if(!n||6!==n.length)throw Error("Unexpected return format from get_cycle_summary - expected 6 values");let[c,u,m,x,h,g]=n.map((e,r)=>{switch(r){case 0:case 1:case 2:return parseInt(new DataView(new Uint8Array(e[0]).buffer).getBigUint64(0,!0).toString());case 3:return"0x"+Array.from(new Uint8Array(e[0])).map(e=>e.toString(16).padStart(2,"0")).join("");case 4:return e[0][0];case 5:return 1===e[0][0];default:return e[0]}});return{currentCycle:c,contributionsReceived:u,totalExpected:m,nextRecipientAddress:x,nextRecipientPosition:h,allContributed:g}}async function m(e){var r,s;let t=new d.Z;t.moveCall({target:"".concat("0xc9be599a1ce3605fcccaf86a1cd857d09bdf7f5f2acc39b775d13b1cbff52c35","::codeforge::get_contribution_status"),arguments:[t.object(e)]});let a=new i.x({url:(0,o.T)("testnet")}),l=await a.devInspectTransactionBlock({transactionBlock:t,sender:"0x0000000000000000000000000000000000000000000000000000000000000000"});if(l.error)throw Error("Failed to get contribution status: ".concat(l.error));let n=null==(s=l.results)||null==(r=s[0])?void 0:r.returnValues;if(!n||4!==n.length)throw Error("Expected 4 return values (u64, u64, vector<address>, vector<address>)");let[u,m,x,h]=n,g=c.jy.u64().parse(new Uint8Array(u[0])),b=c.jy.u64().parse(new Uint8Array(m[0])),f=c.jy.vector(c.jy.Address).parse(new Uint8Array(x[0])),p=c.jy.vector(c.jy.Address).parse(new Uint8Array(h[0]));return{currentContribution:Number(g),expectedTotal:Number(b),contributors:f,pending:p}}var x=s(5322),h=s(5676),g=s(6167),b=s(794),f=s(7104),p=s(5560),y=s(9200);function v(){let[e,r]=(0,a.useState)(!0),[s,i]=(0,a.useState)(!0),[o,d]=(0,a.useState)(!1),[c,y]=(0,a.useState)(null),[v,j]=(0,a.useState)(!0),[w,N]=(0,a.useState)([]),[k,C]=(0,a.useState)(""),[S,_]=(0,a.useState)(0),[A,E]=(0,a.useState)(""),[D,U]=(0,a.useState)(0),[R,M]=(0,a.useState)(0),[q,P]=(0,a.useState)(0),[B,G]=(0,a.useState)([]),[T,I]=(0,a.useState)("0x0000000000000000000000000000000000000000000000000000000000000000"),[L,F]=(0,a.useState)(""),[V,K]=(0,a.useState)(!1),[O,W]=(0,a.useState)(0),[X,Z]=(0,a.useState)(0),z=(0,l.useRouter)(),{id:H}=z.query,J=(0,a.useContext)(g.Rs);if(!J)throw Error("Component must be used within a UserProvider");let[Y,Q]=J,$="0xc9be599a1ce3605fcccaf86a1cd857d09bdf7f5f2acc39b775d13b1cbff52c35";if(!$)throw Error("NEXT_PUBLIC_MOVE_PACKAGE_ID environment variable is required");let ee=new h.NM({packageId:$,network:"testnet"});(0,a.useEffect)(()=>{for(var e in w){if(console.log("running ..."),w[e].wallet_address===T){F(w[e].user.username),console.log("found the recipient");return}F("Pending ...")}},[T,w]),(0,a.useEffect)(()=>{if(!(0,x.wR)())return void z.push("/");if(z.isReady&&H){er(H);let e=z.query.link;e&&"string"==typeof e&&u(e).then(s=>{console.log(s),M(s.contributionsReceived),P(s.totalExpected/1e9),I(s.nextRecipientAddress),K(s.allContributed),W(s.currentCycle),m(e).then(e=>{console.log(e),G(e.contributors)}).catch(e=>{console.error(e)}).then(()=>{r(!1)})}),(0,b.Ay)("https://suifunds.yuviewenergy.com"+"/ajosavingsgroup/".concat(H)).then(e=>{if(e.type===b.yl.SUCCESS){console.log(e);let s=e.payload.participants,t=[];for(var r in s){let e=s[r];e.wallet_address=f.h.fromSecretKey(e.wallet_address).getPublicKey().toSuiAddress(),t.push(e)}N(t),C(e.payload.name),E(e.payload.description),_(parseFloat(e.payload.contribution_amount)),U(e.payload.cycle_duration_days),Z(e.payload.start_cycle)}}).then(()=>{j(!1),i(!1)})}},[z,H]);let er=async e=>{try{y({id:e,name:"Swift Growth Ajo group",purpose:"A reliable monthly savings group for swift growth.",contribution:1e4,frequency:"Monthly",members:4,nextPayout:"2025-06-31",currentRecipient:L,founder:"Nancy James"})}catch(e){console.error("Error fetching group details:",e),n.oR.error("Failed to fetch group details")}finally{j(!1)}};return v?(0,t.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):c?(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,t.jsx)("div",{className:"bg-white border-b border-gray-200 px-8 py-4",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-blue-600",children:"Your groups"}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsxs)("span",{className:"text-gray-700 mr-3",children:[Y.user.username,"!"]}),(0,t.jsx)("div",{className:"w-10 h-10 bg-orange-400 rounded-full flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-white font-medium text-sm",children:"E"})}),(0,t.jsx)("div",{className:"ml-2",children:(0,t.jsx)("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]})}),(0,t.jsxs)("div",{className:"flex-1 p-1 md:p-8 bg-gray-50 overflow-y-auto",children:[e?(0,t.jsx)(p.GroupDetailsDashboard,{}):(0,t.jsxs)("div",{className:"bg-white rounded-lg p-6 mb-6 shadow-sm border border-gray-200",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:k}),(0,t.jsx)("svg",{onClick:()=>{window.open("https://suiscan.xyz/testnet/tx/".concat(z.query.digest))},className:"w-5 h-5 text-gray-600 hover:text-blue-600 cursor-pointer transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:"Purpose:"})," ",A]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:"Total Contribution (SUI):"})," ",R/1e9]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:"Cycle Duration (days):"})," ",D]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:"Members:"})," ",w.length]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:"Contribution Amount (SUI):"})," ",S]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:"Expected Total Amount (SUI):"})," ",q]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:"Cycle Count:"})," ",O]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:"Current Recipient:"})," ",L]})]}),(0,t.jsxs)("div",{className:"flex flex-col md:flex-row justify-between my-4 gap-2",children:[(0,t.jsx)("button",{className:"relative ".concat(o?"bg-gray-500":"bg-gradient-to-r from-emerald-500 to-teal-600"," inline-flex items-center justify-center px-8 py-4 text-sm font-semibold text-white  rounded-xl shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300 ease-out border border-emerald-400/20 backdrop-blur-sm overflow-hidden group"),onClick:()=>{if(o)return;let e=Array.isArray(z.query.link)?z.query.link[0]:z.query.link;e&&(console.log(S),d(!0),ee.contribute(e,S,Y.wallet_address).then(e=>{console.log(e),n.oR.info("Contribution Added"),d(!1)}))},children:"\uD83D\uDCB0 Contribute"}),(0,t.jsx)("button",{className:"relative inline-flex items-center justify-center px-8 py-4 text-sm font-semibold rounded-xl shadow-lg transition-all duration-300 ease-out border ".concat(V&&"0x0000000000000000000000000000000000000000000000000000000000000000"!==T?"text-white bg-gradient-to-r from-purple-500 to-indigo-600 hover:shadow-xl transform hover:scale-105 border-purple-400/20 backdrop-blur-sm":V?"text-white bg-gradient-to-r from-green-500 to-teal-600 hover:shadow-xl transform hover:scale-105 border-green-400/20 backdrop-blur-sm":"text-gray-400 bg-gray-200 cursor-not-allowed border-gray-300"),onClick:()=>{if(!V)return;let e=Array.isArray(z.query.link)?z.query.link[0]:z.query.link;e&&("0x0000000000000000000000000000000000000000000000000000000000000000"!==T||ee.startNewCycle(e,Y.wallet_address).then(e=>{console.log(e)}).then(()=>{z.reload()}))},disabled:!V,children:V?"0x0000000000000000000000000000000000000000000000000000000000000000"!==T?"✍️ Sign Payout":"\uD83D\uDD04 Start New Cycle":"Waiting for all contributions"})]})]}),e?(0,t.jsx)(p.GroupDetailsMembers,{}):(0,t.jsxs)("div",{className:"bg-white rounded-lg p-6 mb-4 shadow-sm border border-gray-200",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-6 border-b-2 border-blue-500 pb-2 inline-block",children:"Members Contributed"}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:w.map(e=>{for(var r in console.log(e),B)if(e.wallet_address===B[r])return(0,t.jsxs)("div",{className:"flex items-center bg-blue-500 text-white p-4 rounded-lg",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-gray-300 rounded-full mr-4 overflow-hidden",children:(0,t.jsx)("div",{className:"w-full h-full bg-blue-400 flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-white font-bold text-lg",children:e.user.username.split(" ").map(e=>e[0]).join("")})})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h3",{className:"font-semibold text-lg",children:["Name: ",e.user.username]}),(0,t.jsxs)("p",{className:"text-blue-100",children:["email: ",e.user.email]})]})]},e.id)})})]}),s?(0,t.jsx)(p.GroupDetailsMembers,{}):(0,t.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-6 border-b-2 border-blue-500 pb-2 inline-block",children:"Members Details"}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:w.map(e=>(0,t.jsxs)("div",{className:"flex md:items-center bg-blue-500 text-white p-4 rounded-lg",children:[(0,t.jsx)("div",{className:"hidden md:block w-16 h-16 bg-gray-300 rounded-full mr-4 overflow-hidden",children:(0,t.jsx)("div",{className:"w-full h-full bg-blue-400 flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-white font-bold text-lg",children:e.user.username.split(" ").map(e=>e[0]).join("")})})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h3",{className:"font-semibold lg:text-lg",children:["Name: ",e.user.username]}),(0,t.jsxs)("p",{className:"text-blue-100",children:["email: ",e.user.email]})]})]},e.id))})]})]})]})}):(0,t.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-700",children:"Group not found"}),(0,t.jsx)("button",{onClick:()=>z.push("/ajo-groups"),className:"mt-4 bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-md",children:"Back to Groups"})]})})}v.getLayout=function(e){return(0,t.jsx)(y.A,{children:e})}},9028:(e,r,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/ajo-groups/details",function(){return s(6781)}])}},e=>{var r=r=>e(e.s=r);e.O(0,[141,528,676,636,593,792],()=>r(9028)),_N_E=e.O()}]);